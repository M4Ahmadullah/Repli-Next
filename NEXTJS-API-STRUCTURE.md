# üöÄ Next.js Team API Structure & Responsibilities
**Complete Integration Guide for Multi-Bot WhatsApp Platform**

## üéØ Overview
As the **Next.js Frontend/Dashboard Team**, we are responsible for creating the **user interface and data collection layer** that allows users to interact with our bot system. We are the "control panel" - the bot system is the "engine".

### Our Mission
- ‚úÖ Build beautiful, responsive user interfaces
- ‚úÖ Collect and validate user inputs  
- ‚úÖ Forward requests to bot system
- ‚úÖ Display real-time data from bot system
- ‚úÖ Handle user authentication and profiles
- ‚ùå **NOT** handle bot logic, WhatsApp integration, or AI processing

## üèóÔ∏è API Architecture

### Core Principle: Request Forwarding Pattern
```
User Input ‚Üí Next.js Validation ‚Üí Bot System Request ‚Üí UI Update
```

**We DO NOT handle bot logic directly.** We collect, validate, and forward user requests to the bot system.

## üìã Complete API Endpoints Structure

### 1. Bot Request APIs (`/api/bot-requests/`)
**Purpose**: Collect user requests and forward them to the bot system

| Endpoint | Method | Purpose | Bot System Endpoint |
|----------|--------|---------|-------------------|
| `/api/bot-requests/create` | POST | Create new bot | `POST ${BOT_SYSTEM_URL}/api/bots` |
| `/api/bot-requests/train` | POST | Send training data | `POST ${BOT_SYSTEM_URL}/api/bots/{botId}/training` |
| `/api/bot-requests/connect` | POST | WhatsApp connection | `POST ${BOT_SYSTEM_URL}/api/whatsapp/qr/{botId}` |
| `/api/bot-requests/status` | GET | Get bot status | `GET ${BOT_SYSTEM_URL}/api/bots/{botId}/status` |

#### `POST /api/bot-requests/create`
**Purpose**: Create new bot instances
**Responsibilities**:
- ‚úÖ Validate user input (name, description, personality)
- ‚úÖ Check user's plan limits (free: 1 bot, starter: 3 bots, etc.)
- ‚úÖ Generate unique request ID for tracking
- ‚úÖ Forward request to bot system: `POST ${BOT_SYSTEM_URL}/api/bots`
- ‚úÖ Update user's bot list in Firebase
- ‚ùå Don't create bot logic or WhatsApp connections

**Request Body**:
```json
{
  "name": "Customer Support Bot",
  "description": "Handles customer inquiries",
  "personality": "professional"
}
```

**Response**:
```json
{
  "success": true,
  "bot": {
    "id": "bot_123",
    "name": "Customer Support Bot",
    "status": "creating",
    "whatsappConnected": false
  },
  "requestId": "req_1234567890_abc123"
}
```

#### `POST /api/bot-requests/train`
**Purpose**: Collect training data and send to bot system
**Responsibilities**:
- ‚úÖ Validate Q&A pairs, business info, personality settings
- ‚úÖ Check plan limits (free: 5 Q&A pairs, starter: 25, etc.)
- ‚úÖ Format training data for bot system
- ‚úÖ Forward to bot system: `POST ${BOT_SYSTEM_URL}/api/bots/{botId}/training`
- ‚úÖ Update user's bot training status
- ‚ùå Don't process documents or create AI responses

**Request Body**:
```json
{
  "botId": "bot_123",
  "businessInfo": {
    "name": "Acme Corp",
    "description": "We sell widgets",
    "industry": "Manufacturing",
    "website": "https://acme.com"
  },
  "qnaPairs": [
    {
      "question": "What are your business hours?",
      "answer": "We're open Monday-Friday 9am-5pm EST"
    }
  ],
  "personality": "professional",
  "autoRespond": true,
  "fallbackMessage": "I'll connect you with a human agent."
}
```

#### `POST /api/bot-requests/connect`
**Purpose**: Handle WhatsApp connection requests
**Responsibilities**:
- ‚úÖ Validate bot ownership
- ‚úÖ Forward QR generation requests to bot system
- ‚úÖ Check connection status from bot system
- ‚úÖ Handle disconnect requests
- ‚úÖ Update user's bot connection status
- ‚ùå Don't generate QR codes or handle WhatsApp webhooks

**Request Body**:
```json
{
  "botId": "bot_123",
  "action": "generate-qr" // or "check-status" or "disconnect"
}
```

#### `GET /api/bot-requests/status`
**Purpose**: Get real-time bot status from bot system
**Responsibilities**:
- ‚úÖ Query bot system for current status
- ‚úÖ Aggregate analytics from multiple bots
- ‚úÖ Format data for dashboard display
- ‚úÖ Handle bot system unavailability gracefully
- ‚ùå Don't store or calculate analytics ourselves

### 2. Dashboard Data APIs (`/api/dashboard/`)
**Purpose**: Aggregate and display data from bot system

| Endpoint | Method | Purpose | Bot System Endpoints |
|----------|--------|---------|-------------------|
| `/api/dashboard/stats` | GET | User dashboard stats | Multiple analytics endpoints |
| `/api/dashboard/bots` | GET | User's bot list | `GET ${BOT_SYSTEM_URL}/api/bots/user/{userId}` |
| `/api/dashboard/analytics` | GET | Combined analytics | `GET ${BOT_SYSTEM_URL}/api/analytics/{botId}` |

#### `GET /api/dashboard/stats`
**Purpose**: Aggregate dashboard statistics for user
**Responsibilities**:
- ‚úÖ Fetch analytics from bot system for all user's bots
- ‚úÖ Calculate usage percentages vs plan limits
- ‚úÖ Aggregate totals (messages, response times, etc.)
- ‚úÖ Format data for dashboard components
- ‚ùå Don't calculate analytics ourselves

**Response**:
```json
{
  "success": true,
  "user": {
    "id": "user_123",
    "plan": "starter",
    "planStatus": "active"
  },
  "overview": {
    "totalBots": 2,
    "connectedBots": 1,
    "activeBots": 1,
    "trainingBots": 1
  },
  "analytics": {
    "totalMessages": 1250,
    "todayMessages": 45,
    "weeklyMessages": 320,
    "monthlyMessages": 1100,
    "averageResponseTime": 1200
  },
  "usage": {
    "bots": { "current": 2, "limit": 3, "percentage": 67 },
    "dailyMessages": { "current": 45, "limit": 100, "percentage": 45 }
  }
}
```

### 3. User Management APIs (`/api/users/`)
**Purpose**: Handle user profiles and subscription management

| Endpoint | Method | Purpose | Firebase/Clerk |
|----------|--------|---------|----------------|
| `/api/users/[userId]` | GET | Get user profile | Firebase read |
| `/api/users/[userId]` | PUT | Update user profile | Firebase update |
| `/api/users/[userId]` | DELETE | Delete user account | Firebase delete |

#### `GET /api/users/[userId]`
**Purpose**: Get user profile and subscription info
**Responsibilities**:
- ‚úÖ Return user profile from Firebase
- ‚úÖ Include subscription details and limits
- ‚úÖ Include user's bot list
- ‚ùå Don't include sensitive bot system data

#### `PUT /api/users/[userId]`
**Purpose**: Update user profile
**Responsibilities**:
- ‚úÖ Validate profile updates
- ‚úÖ Update Firebase user document
- ‚úÖ Sync changes with bot system if needed
- ‚ùå Don't update bot configurations directly

### 4. Subscription Management APIs (`/api/subscriptions/`)
**Purpose**: Handle user subscription and billing

| Endpoint | Method | Purpose | Integration |
|----------|--------|---------|-------------|
| `/api/subscriptions/[userId]` | GET | Get subscription details | Firebase + Stripe |
| `/api/subscriptions/[userId]` | PUT | Update subscription | Firebase + Stripe |

### 5. Webhook APIs (`/api/webhooks/`)
**Purpose**: Handle external service webhooks

| Endpoint | Method | Purpose | Service |
|----------|--------|---------|---------|
| `/api/webhooks/clerk` | POST | Clerk user events | Clerk webhook |
| `/api/webhooks/stripe` | POST | Stripe billing events | Stripe webhook |

## üîÑ Integration Patterns

### 1. Request Forwarding Pattern
```typescript
// ‚úÖ CORRECT: Collect, validate, forward
async function createBot(userData: CreateBotData) {
  // 1. Validate user input
  const validatedData = validateBotData(userData)
  
  // 2. Check user limits
  const user = await getUserById(userId)
  if (user.bots.length >= planLimits[user.plan]) {
    throw new Error('Bot limit reached')
  }
  
  // 3. Forward to bot system
  const response = await fetch(`${BOT_SYSTEM_URL}/api/bots`, {
    method: 'POST',
    body: JSON.stringify({
      userId,
      requestId: generateRequestId(),
      ...validatedData
    })
  })
  
  // 4. Update UI state
  const botResult = await response.json()
  await updateUserBots(userId, botResult.bot)
  
  return botResult
}
```

### 2. Status Monitoring Pattern
```typescript
// ‚úÖ CORRECT: Query bot system, format for UI
async function getBotStatus(botId: string) {
  // 1. Get status from bot system
  const statusResponse = await fetch(`${BOT_SYSTEM_URL}/api/bots/${botId}/status`)
  const analyticsResponse = await fetch(`${BOT_SYSTEM_URL}/api/analytics/${botId}`)
  
  // 2. Format for dashboard
  return {
    botId,
    status: statusResponse.status,
    analytics: analyticsResponse.data,
    lastUpdated: new Date()
  }
}
```

### 3. Error Handling Pattern
```typescript
// ‚úÖ CORRECT: Graceful degradation when bot system unavailable
try {
  const botSystemData = await fetch(`${BOT_SYSTEM_URL}/api/...`)
  return botSystemData
} catch (error) {
  console.error('Bot system unavailable:', error)
  // Return cached data from Firebase
  return getCachedBotData(botId)
}
```

## üö´ What We DON'T Do

### ‚ùå Bot Logic Management
```typescript
// ‚ùå WRONG: Don't implement bot responses
function generateBotResponse(message: string) {
  // This belongs in the bot system!
}

// ‚ùå WRONG: Don't handle WhatsApp webhooks
app.post('/webhook', (req, res) => {
  // Bot system handles this!
})
```

### ‚ùå Direct WhatsApp Integration
```typescript
// ‚ùå WRONG: Don't call UltraMsg directly
const response = await fetch('https://api.ultramsg.com/...') 

// ‚úÖ CORRECT: Forward to bot system
const response = await fetch(`${BOT_SYSTEM_URL}/api/whatsapp/...`)
```

### ‚ùå Training Data Processing
```typescript
// ‚ùå WRONG: Don't process documents
function extractTextFromPDF(file: File) {
  // Bot system handles this!
}

// ‚úÖ CORRECT: Forward file to bot system
const formData = new FormData()
formData.append('document', file)
await fetch(`${BOT_SYSTEM_URL}/api/bots/${botId}/documents`, {
  method: 'POST',
  body: formData
})
```

## üé® UI Components Integration

### Dashboard Usage
```typescript
// ‚úÖ CORRECT: Use our dashboard stats API
const { data } = await fetch('/api/dashboard/stats')
// Display aggregated data in dashboard components
```

### Bot Creation Wizard
```typescript
// ‚úÖ CORRECT: Collect user input, forward to our API
const botData = {
  name: 'Support Bot',
  description: 'Customer support',
  personality: 'professional'
}

const response = await fetch('/api/bot-requests/create', {
  method: 'POST',
  body: JSON.stringify(botData)
})
```

### Real-time Status Updates
```typescript
// ‚úÖ CORRECT: Poll our status API
setInterval(async () => {
  const status = await fetch(`/api/bot-requests/status?botId=${botId}`)
  updateBotStatus(status.data)
}, 30000) // Every 30 seconds
```

## üîß Required Environment Variables

```env
# Bot System Integration (CRITICAL FOR COMMUNICATION)
BOT_SYSTEM_URL=http://localhost:4000
BOT_SYSTEM_API_KEY=your_secure_bot_system_api_key

# Firebase (for user data storage)
FIREBASE_PROJECT_ID=your_project_id
FIREBASE_CLIENT_EMAIL=your_service_account_email
FIREBASE_PRIVATE_KEY=your_private_key

# Clerk Authentication
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...
CLERK_SECRET_KEY=sk_test_...
CLERK_WEBHOOK_SECRET=whsec_...

# Stripe (for subscriptions)
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...

# App Configuration
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

## üìä Plan Limits & Validation

### Bot Limits by Plan
```typescript
const BOT_LIMITS = {
  free: { bots: 1, dailyMessages: 10, monthlyMessages: 300, qnaPairs: 5 },
  starter: { bots: 3, dailyMessages: 100, monthlyMessages: 3000, qnaPairs: 25 },
  growth: { bots: 10, dailyMessages: 500, monthlyMessages: 15000, qnaPairs: 100 },
  enterprise: { bots: 50, dailyMessages: 2000, monthlyMessages: 60000, qnaPairs: 500 }
}
```

### Validation Rules
- **Bot Creation**: Check user.bots.length < LIMITS[plan].bots
- **Training Data**: Check qnaPairs.length < LIMITS[plan].qnaPairs  
- **Daily Usage**: Check todayMessages < LIMITS[plan].dailyMessages
- **Monthly Usage**: Check monthlyMessages < LIMITS[plan].monthlyMessages

## üìä Success Metrics

### ‚úÖ We're Successful When:
- Users can easily create and manage multiple bots
- Training wizard is intuitive and fast
- Dashboard shows real-time bot status and analytics
- All user interactions are smooth and responsive
- Error states are handled gracefully
- Bot system integration is seamless

### üìà Key Performance Indicators:
- Bot creation completion rate > 90%
- Training wizard abandonment rate < 10%
- Dashboard load time < 2 seconds
- API response time < 500ms
- User satisfaction score > 4.5/5

## üöÄ Deployment Checklist

### Before Deploying:
- [ ] All API endpoints validate user input with Zod schemas
- [ ] Plan limits are enforced correctly before forwarding requests
- [ ] Error handling covers bot system unavailability gracefully
- [ ] User data is properly synced with Firebase
- [ ] Dashboard aggregates data correctly from bot system
- [ ] Bot creation wizard works end-to-end
- [ ] Real-time status updates function properly
- [ ] Clerk authentication is properly configured
- [ ] Environment variables are set correctly
- [ ] Bot system communication is tested

## ü§ù Communication Protocol with Bot System Team

### When We Need Something from Bot System:
1. **New API Endpoints**: Request specific endpoints with expected input/output
2. **Data Format Changes**: Ask for modifications to response structures
3. **Status Updates**: Request real-time status information
4. **Error Handling**: Report integration issues and error scenarios

### What Bot System Can Expect from Us:
1. **Consistent Data Format**: We'll always send data in agreed formats
2. **Proper Authentication**: All requests include valid API keys
3. **Request IDs**: Every request includes unique tracking ID
4. **User Context**: We'll provide user plan, limits, and permissions
5. **Error Reporting**: We'll report integration issues promptly

### API Contract Examples:

#### Bot Creation Request to Bot System:
```json
POST ${BOT_SYSTEM_URL}/api/bots
{
  "userId": "user_123",
  "requestId": "req_1234567890_abc123",
  "name": "Customer Support Bot",
  "description": "Handles customer inquiries",
  "personality": "professional",
  "userPlan": "starter",
  "userLimits": {
    "dailyMessages": 100,
    "monthlyMessages": 3000
  }
}
```

#### Expected Bot System Response:
```json
{
  "success": true,
  "botId": "bot_456",
  "status": "creating",
  "estimatedCompletion": "2-3 minutes",
  "webhookUrl": "https://bot-system.com/webhook/bot_456"
}
```

## üîÑ Data Flow Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   User Browser  ‚îÇ    ‚îÇ  Next.js APIs   ‚îÇ    ‚îÇ  Bot System     ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ ‚Ä¢ Dashboard UI  ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ ‚Ä¢ Validation    ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ ‚Ä¢ Bot Logic     ‚îÇ
‚îÇ ‚Ä¢ Bot Creation  ‚îÇ    ‚îÇ ‚Ä¢ Plan Limits   ‚îÇ    ‚îÇ ‚Ä¢ WhatsApp API  ‚îÇ
‚îÇ ‚Ä¢ Training UI   ‚îÇ    ‚îÇ ‚Ä¢ Request       ‚îÇ    ‚îÇ ‚Ä¢ AI Processing ‚îÇ
‚îÇ ‚Ä¢ Analytics     ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÇ   Forwarding    ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÇ ‚Ä¢ Analytics     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚ñº                       ‚ñº                       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     Clerk       ‚îÇ    ‚îÇ    Firebase     ‚îÇ    ‚îÇ   UltraMsg      ‚îÇ
‚îÇ Authentication  ‚îÇ    ‚îÇ  User Storage   ‚îÇ    ‚îÇ  WhatsApp API   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üìã Complete Project Structure

```
repli-nextjs/
‚îú‚îÄ‚îÄ üìÑ Configuration Files
‚îÇ   ‚îú‚îÄ‚îÄ .env.local              # Environment variables (copy from .env.local.example)
‚îÇ   ‚îú‚îÄ‚îÄ .gitignore              # Git ignore patterns
‚îÇ   ‚îú‚îÄ‚îÄ components.json         # ShadCN UI configuration
‚îÇ   ‚îú‚îÄ‚îÄ eslint.config.mjs       # ESLint configuration
‚îÇ   ‚îú‚îÄ‚îÄ middleware.ts           # Clerk authentication middleware
‚îÇ   ‚îú‚îÄ‚îÄ next.config.ts          # Next.js configuration
‚îÇ   ‚îú‚îÄ‚îÄ package.json            # Dependencies and scripts
‚îÇ   ‚îú‚îÄ‚îÄ postcss.config.mjs      # PostCSS configuration
‚îÇ   ‚îú‚îÄ‚îÄ tailwind.config.js      # Tailwind CSS configuration
‚îÇ   ‚îî‚îÄ‚îÄ tsconfig.json           # TypeScript configuration
‚îÇ
‚îú‚îÄ‚îÄ üìö Documentation
‚îÇ   ‚îú‚îÄ‚îÄ BOT-AUTHENTICATION-INTEGRATION.md    # Bot team integration guide
‚îÇ   ‚îú‚îÄ‚îÄ EXPRESS-BOT-CLERK-INTEGRATION.md     # Express bot integration
‚îÇ   ‚îú‚îÄ‚îÄ NEXTJS-API-STRUCTURE.md              # This file - API structure
‚îÇ   ‚îú‚îÄ‚îÄ README.md                            # Project overview
‚îÇ   ‚îú‚îÄ‚îÄ REPLI-BOT-DOCUMENTATION.md           # Bot documentation
‚îÇ   ‚îî‚îÄ‚îÄ SETUP-GUIDE.md                       # Setup instructions
‚îÇ
‚îú‚îÄ‚îÄ üåê Public Assets
‚îÇ   ‚îî‚îÄ‚îÄ public/
‚îÇ       ‚îú‚îÄ‚îÄ file.svg
‚îÇ       ‚îú‚îÄ‚îÄ globe.svg
‚îÇ       ‚îú‚îÄ‚îÄ next.svg
‚îÇ       ‚îú‚îÄ‚îÄ vercel.svg
‚îÇ       ‚îî‚îÄ‚îÄ window.svg
‚îÇ
‚îî‚îÄ‚îÄ üíª Source Code
    ‚îî‚îÄ‚îÄ src/
        ‚îú‚îÄ‚îÄ üì± App Router
        ‚îÇ   ‚îî‚îÄ‚îÄ app/
        ‚îÇ       ‚îú‚îÄ‚îÄ (auth)/                    # üîê Authentication routes
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx             # Auth layout with pixel background
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ sign-in/[[...sign-in]]/page.tsx
        ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ sign-up/[[...sign-up]]/page.tsx
        ‚îÇ       ‚îÇ
        ‚îÇ       ‚îú‚îÄ‚îÄ (dashboard)/               # üõ°Ô∏è Protected dashboard routes
        ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ dashboard/page.tsx     # Multi-bot dashboard
        ‚îÇ       ‚îÇ
        ‚îÇ       ‚îú‚îÄ‚îÄ üîå API Routes
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ bot-requests/          # üéØ CORE: Forward to bot system
        ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ connect/route.ts   # WhatsApp connection requests
        ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ create/route.ts    # Bot creation requests
        ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ status/route.ts    # Bot status monitoring
        ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ train/route.ts     # Training data forwarding
        ‚îÇ       ‚îÇ   ‚îÇ
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/             # üìä Dashboard data aggregation
        ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ stats/route.ts     # Aggregate analytics from bot system
        ‚îÇ       ‚îÇ   ‚îÇ
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ subscriptions/         # üí≥ Subscription management
        ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [userId]/route.ts  # User subscription CRUD
        ‚îÇ       ‚îÇ   ‚îÇ
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ users/                 # üë§ User profile management
        ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [userId]/route.ts  # User profile CRUD
        ‚îÇ       ‚îÇ   ‚îÇ
        ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ webhooks/              # üîó External service webhooks
        ‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ clerk/route.ts     # Clerk user sync webhook
        ‚îÇ       ‚îÇ
        ‚îÇ       ‚îú‚îÄ‚îÄ üìÑ Pages
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx             # Root layout with providers
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx               # Landing page
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ pricing/page.tsx       # Pricing page
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ not-found.tsx          # 404 page
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ globals.css            # Global styles
        ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ favicon.ico            # Favicon
        ‚îÇ
        ‚îú‚îÄ‚îÄ üß© Components
        ‚îÇ   ‚îî‚îÄ‚îÄ components/
        ‚îÇ       ‚îú‚îÄ‚îÄ dashboard/                 # üìä Dashboard-specific components
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ bot-creation-wizard.tsx    # Multi-step bot creation
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ bot-selector.tsx           # Bot switching interface
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ bot-status-monitor.tsx     # Real-time status display
        ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ whatsapp-setup.tsx         # WhatsApp connection UI
        ‚îÇ       ‚îÇ
        ‚îÇ       ‚îú‚îÄ‚îÄ layout/                    # üèóÔ∏è Layout components
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ conditional-layout.tsx     # Conditional header/footer
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ footer.tsx                 # Site footer
        ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ header.tsx                 # Navigation with auth
        ‚îÇ       ‚îÇ
        ‚îÇ       ‚îú‚îÄ‚îÄ providers/                 # üîß Context providers
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ clerk-provider.tsx         # Clerk auth with theming
        ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ theme-provider.tsx         # Dark/light mode
        ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ providers.tsx              # Combined providers
        ‚îÇ       ‚îÇ
        ‚îÇ       ‚îî‚îÄ‚îÄ ui/                        # üé® Reusable UI components (ShadCN)
        ‚îÇ           ‚îú‚îÄ‚îÄ avatar.tsx, badge.tsx, button.tsx
        ‚îÇ           ‚îú‚îÄ‚îÄ card.tsx, checkbox.tsx, dialog.tsx
        ‚îÇ           ‚îú‚îÄ‚îÄ dropdown-menu.tsx, form.tsx, input.tsx
        ‚îÇ           ‚îú‚îÄ‚îÄ label.tsx, select.tsx, sheet.tsx
        ‚îÇ           ‚îú‚îÄ‚îÄ table.tsx, tabs.tsx, textarea.tsx
        ‚îÇ           ‚îî‚îÄ‚îÄ theme-toggle.tsx
        ‚îÇ
        ‚îî‚îÄ‚îÄ üìö Library
            ‚îî‚îÄ‚îÄ lib/
                ‚îú‚îÄ‚îÄ api/                       # üåê API client utilities
                ‚îÇ   ‚îî‚îÄ‚îÄ client.ts              # HTTP client wrapper
                ‚îÇ
                ‚îú‚îÄ‚îÄ firebase/                  # üî• Firebase configuration
                ‚îÇ   ‚îú‚îÄ‚îÄ admin.ts               # Server-side Firebase admin
                ‚îÇ   ‚îî‚îÄ‚îÄ config.ts              # Client-side Firebase config
                ‚îÇ
                ‚îú‚îÄ‚îÄ services/                  # üîß Business logic services
                ‚îÇ   ‚îî‚îÄ‚îÄ user.service.ts        # User data management (Firebase)
                ‚îÇ
                ‚îú‚îÄ‚îÄ types/                     # üìù TypeScript definitions
                ‚îÇ   ‚îî‚îÄ‚îÄ user.ts                # User, Bot, Subscription interfaces
                ‚îÇ
                ‚îî‚îÄ‚îÄ utils.ts                   # üõ†Ô∏è Utility functions
```

## üéØ Key Implementation Details

### ‚úÖ Implemented & Working
- **Multi-Bot Architecture**: Users can create and manage multiple bots
- **Clerk Authentication**: Complete auth flow with custom styling
- **Plan Limit Enforcement**: Validates bot creation against subscription limits
- **Request Forwarding**: All bot operations forward to bot system APIs
- **Real-time Dashboard**: Aggregates data from multiple bots
- **Error Handling**: Graceful degradation when bot system unavailable
- **TypeScript**: Full type safety with comprehensive interfaces
- **Responsive UI**: Mobile-friendly dashboard and landing page

### üîÑ Request Flow Examples
```
1. Bot Creation:
   User Dashboard ‚Üí /api/bot-requests/create ‚Üí Bot System ‚Üí Firebase Update

2. Training Data:
   Training Form ‚Üí /api/bot-requests/train ‚Üí Bot System ‚Üí Status Update

3. WhatsApp Connection:
   Setup Component ‚Üí /api/bot-requests/connect ‚Üí Bot System ‚Üí QR Code Display

4. Dashboard Stats:
   Dashboard Load ‚Üí /api/dashboard/stats ‚Üí Bot System Analytics ‚Üí Aggregated Display
```

## üéØ Success Criteria Summary

### ‚úÖ Next.js Team Delivers:
- **Beautiful Multi-Bot Dashboard**: Users can create, manage, and monitor multiple bots
- **Intuitive Bot Creation Wizard**: Step-by-step bot setup with training data collection
- **Real-time Status Monitoring**: Live updates from bot system displayed in UI
- **Comprehensive Analytics Dashboard**: Aggregated data from all user's bots
- **Seamless Authentication**: Clerk integration with proper user management
- **Plan Limit Enforcement**: Proper validation before forwarding to bot system
- **Error Handling**: Graceful degradation when bot system is unavailable

### ü§ñ Bot System Team Delivers:
- **Bot Logic & AI Processing**: Handle all bot intelligence and responses
- **WhatsApp Integration**: Manage UltraMsg API and message routing
- **Training Data Processing**: Convert documents and Q&A into AI knowledge
- **Analytics Generation**: Calculate metrics and usage statistics
- **Multi-Bot Architecture**: Support multiple bots per user
- **Webhook Processing**: Handle incoming WhatsApp messages
- **QR Code Generation**: Manage WhatsApp connection process

Remember: **We build the "control panel" - the bot system IS the actual engine!** üéÆ

## üöÄ Current Status & Next Steps

### ‚úÖ Completed (Ready for Bot Team Integration)
1. **API Structure**: All bot-requests endpoints implemented and tested
2. **Authentication**: Clerk integration with custom styling complete
3. **Multi-Bot Dashboard**: Fully functional with real-time status monitoring
4. **Plan Limits**: Enforced across all bot creation and training endpoints
5. **Error Handling**: Graceful degradation when bot system unavailable
6. **TypeScript**: Complete type definitions for all interfaces
7. **Documentation**: Comprehensive API guide for bot team integration

### üîÑ Ready for Bot Team
- **Environment Variables**: Set `BOT_SYSTEM_URL` and `BOT_SYSTEM_API_KEY`
- **API Endpoints**: All `/api/bot-requests/*` routes ready to forward requests
- **Data Formats**: Consistent request/response formats documented above
- **Authentication**: User context included in all bot system requests
- **Plan Validation**: User limits checked before forwarding requests

### üéØ Integration Checklist for Bot Team
- [ ] Set up bot system API endpoints matching our documented structure
- [ ] Implement webhook callbacks for status updates
- [ ] Test request/response formats with our API endpoints
- [ ] Configure WhatsApp Business API integration
- [ ] Set up analytics data collection for dashboard aggregation

### üìû Support & Communication
- **Issues**: Report integration issues via GitHub issues
- **Questions**: Contact Next.js team for API clarifications
- **Changes**: Any API format changes require coordination between teams

---

**Last Updated**: December 2024
**Version**: 2.1.0 - Final Implementation
**Team**: Next.js Frontend/Dashboard Team
**Status**: ‚úÖ Ready for Bot Team Integration 